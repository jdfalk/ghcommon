# file: .github/workflows/security.yml
# version: 2.0.0
# guid: s3c4r5t6-y7a8-b9c0-d1e2-f3a4b5c6d7e8

name: Security

on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]
  schedule:
    - cron: "0 6 * * 1" # Weekly on Monday at 6 AM UTC
  workflow_dispatch:
    inputs:
      skip-codeql:
        description: "Skip CodeQL analysis"
        required: false
        type: boolean
        default: false
      skip-dependency-review:
        description: "Skip dependency review"
        required: false
        type: boolean
        default: false
      skip-security-audit:
        description: "Skip security audit"
        required: false
        type: boolean
        default: false

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  security:
    name: Security Analysis
    uses: ./.github/workflows/reusable-security.yml
    with:
      skip-codeql: ${{ inputs.skip-codeql || false }}
      skip-dependency-review: ${{ inputs.skip-dependency-review || false }}
      skip-security-audit: ${{ inputs.skip-security-audit || false }}
    secrets: inherit