# file: .github/workflows/issue-automation.yml
# version: 2.0.1
# guid: f6g7h8i9-j0k1-l2m3-n4o5-p6q7r8s9t0u1

name: Issue Automation

on:
  issues:
    types: [opened, edited, closed, reopened, labeled, unlabeled]
  issue_comment:
    types: [created, edited]
  schedule:
    # Run stale issue check daily at 2 AM UTC
    - cron: "0 2 * * *"
  workflow_dispatch:
    inputs:
      stale-days:
        description: "Days before marking issues as stale"
        required: false
        type: number
        default: 60
      close-days:
        description: "Days before closing stale issues"
        required: false
        type: number
        default: 14
      skip-stale-management:
        description: "Skip stale issue management"
        required: false
        type: boolean
        default: false
      skip-auto-labeling:
        description: "Skip automatic labeling"
        required: false
        type: boolean
        default: false
      skip-auto-assignment:
        description: "Skip automatic assignment"
        required: false
        type: boolean
        default: false

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

permissions:
  issues: write
  pull-requests: write
  contents: read

jobs:
  issue-automation:
    name: Issue Automation
    uses: ./.github/workflows/reusable-issue-automation.yml
    with:
      stale-days: ${{ inputs.stale-days || 60 }}
      close-days: ${{ inputs.close-days || 14 }}
      skip-stale-management: ${{ inputs.skip-stale-management || false }}
      skip-auto-labeling: ${{ inputs.skip-auto-labeling || false }}
      skip-auto-assignment: ${{ inputs.skip-auto-assignment || false }}
    secrets: inherit
