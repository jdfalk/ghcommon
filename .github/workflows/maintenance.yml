# file: .github/workflows/maintenance.yml
# version: 2.0.1
# guid: m4i5n6t7-e8n9-a0b1-c2d3-e4f5a6b7c8d9

name: Maintenance

on:
  schedule:
    - cron: '0 2 * * 1' # Weekly on Monday at 2 AM UTC
    - cron: '0 6 1 * *' # Monthly on 1st at 6 AM UTC
  workflow_dispatch:
    inputs:
      skip-dependency-updates:
        description: 'Skip dependency updates'
        required: false
        type: boolean
        default: false
      skip-cleanup:
        description: 'Skip cleanup tasks'
        required: false
        type: boolean
        default: false
      skip-license-check:
        description: 'Skip license compliance check'
        required: false
        type: boolean
        default: false
      auto-commit:
        description: 'Automatically commit maintenance changes'
        required: false
        type: boolean
        default: false

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

permissions:
  contents: write
  pull-requests: write

jobs:
  maintenance:
    name: Repository Maintenance
    uses: ./.github/workflows/reusable-maintenance.yml
    with:
      skip-dependency-updates: ${{ inputs.skip-dependency-updates || false }}
      skip-cleanup: ${{ inputs.skip-cleanup || false }}
      skip-license-check: ${{ inputs.skip-license-check || false }}
      auto-commit: ${{ inputs.auto-commit || false }}
    secrets: inherit
